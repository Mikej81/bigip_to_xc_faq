<!DOCTYPE html>

<html lang="en" data-content_root="./">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>BIG-IP To Distributed Cloud Conversion Frequently Asked Questions and Tips &#8212; BIG-IP to XC 2024 documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=a746c00c" />
    <link rel="stylesheet" type="text/css" href="_static/nature.css?v=0f882399" />
    <link rel="stylesheet" type="text/css" href="_static/graphviz.css?v=fd3f3429" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <script src="_static/documentation_options.js?v=6fefd858"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="nav-item nav-item-0"><a href="#">BIG-IP to XC 2024 documentation</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">BIG-IP To Distributed Cloud Conversion Frequently Asked Questions and Tips</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="big-ip-to-distributed-cloud-conversion-frequently-asked-questions-and-tips">
<h1>BIG-IP To Distributed Cloud Conversion Frequently Asked Questions and Tips<a class="headerlink" href="#big-ip-to-distributed-cloud-conversion-frequently-asked-questions-and-tips" title="Link to this heading">¶</a></h1>
</section>
<section id="disclaimer">
<span id="id1"></span><h1>Disclaimer<a class="headerlink" href="#disclaimer" title="Link to this heading">¶</a></h1>
<p>Please note that this FAQ document is intended as a general guide and is not exhaustive. While we strive to provide accurate and up-to-date information, the rapidly evolving nature of cloud technologies means that specific details may change over time. Therefore, this guide should not be considered a substitute for professional advice or detailed consultation relevant to your specific circumstances.</p>
</section>
<section id="introduction">
<span id="id2"></span><h1>Introduction<a class="headerlink" href="#introduction" title="Link to this heading">¶</a></h1>
<p>This semi-comprehensive guide is designed to streamline your migration from F5 BIG-IP to F5 Distributed Cloud.  This document aims to address frequently asked questions that arise during the migration process, offering clear, concise answers and practical insights to ensure a smooth transition.</p>
</section>
<section id="disqualifiers">
<span id="id3"></span><h1>Disqualifiers<a class="headerlink" href="#disqualifiers" title="Link to this heading">¶</a></h1>
<p>This is a list of use-cases that can be used to immediately disqualify a migration, with some caveats. There are service chaining use-cases that could still work, or ways to implement policies to redirect traffic to a BIG-IP instead of XC, or ways to inline NGINX into XC to carry out many of the same effects.</p>
</section>
<section id="access-policy-manager">
<h1>Access Policy Manager<a class="headerlink" href="#access-policy-manager" title="Link to this heading">¶</a></h1>
<p>Not all use-cases within APM will be disqualifiers. Just note that the following are not currently supported in XC.</p>
<ol class="arabic simple">
<li><p>Access services that require Match Across.</p>
<ul class="simple">
<li><p>DTLS - SSLVPN</p></li>
<li><p>PCOIP - VDI BLAST works fine</p></li>
</ul>
</li>
</ol>
<p>There are some workable use-cases around Federated Authentication and proxy/service chaining.</p>
<ol class="arabic simple">
<li><p>NTLM</p></li>
</ol>
</section>
<section id="local-traffic-manager">
<h1>Local Traffic Manager<a class="headerlink" href="#local-traffic-manager" title="Link to this heading">¶</a></h1>
<p>There are very few disqualifiers for LTM.</p>
<ol class="arabic simple">
<li><p>Load Balancing services that require Match Across.</p>
<ul class="simple">
<li><p>DTLS</p></li>
<li><p>PCOIP</p></li>
</ul>
</li>
<li><p>Streaming Profiles. We do not support streaming content today in XC LBs.</p>
<ul class="simple">
<li><p>E.g., Rewriting HTML page content.</p></li>
</ul>
</li>
<li><p>OneConnect</p></li>
</ol>
</section>
<section id="tools">
<h1>Tools<a class="headerlink" href="#tools" title="Link to this heading">¶</a></h1>
<p>The following are tools available to use today.  It’s important to note that none of these tools are 100%. It is highly recommended to work with an XC Specialist to help in migration from other platforms to XC.</p>
<ul class="simple">
<li><p>iHealth: <a class="reference external" href="https://ihealth2.f5.com/">iHealth</a></p></li>
<li><p>VS Code Extension: <a class="reference external" href="https://marketplace.visualstudio.com/items?itemName=F5DevCentral.vscode-f5">VS Code Extension</a>
- <a class="reference external" href="https://marketplace.visualstudio.com/items?itemName=F5DevCentral.vscode-f5">VS Code Extension Diagnostics</a></p></li>
<li><p>Policy Supervisor: <a class="reference external" href="https://policysupervisor.io/">Policy Supervisor</a></p></li>
<li><p>BIND to XC Conversion tool: <a class="reference external" href="https://github.com/Mikej81/BINDtoXCDNS">BIND to XC Conversion tool</a></p></li>
<li><p>Domain Keep-Alive Analyzer: <a class="reference external" href="https://keepalive.f5-sa.myedgedemo.com/">Domain Keep-Alive Analyzer</a></p></li>
</ul>
</section>
<section id="apm-to-ditributed-cloud-service-chaining">
<h1>APM to Ditributed Cloud (Service Chaining)<a class="headerlink" href="#apm-to-ditributed-cloud-service-chaining" title="Link to this heading">¶</a></h1>
<p>We covered the disqualifiers, but there are some that will work fine, like service chaining for Federation, or header validation.</p>
<p>[image]</p>
<section id="api-security">
<h2>API Security<a class="headerlink" href="#api-security" title="Link to this heading">¶</a></h2>
</section>
</section>
<section id="qkview-ihealth">
<h1>QKView - iHealth<a class="headerlink" href="#qkview-ihealth" title="Link to this heading">¶</a></h1>
<section id="graphs">
<h2>Graphs<a class="headerlink" href="#graphs" title="Link to this heading">¶</a></h2>
<section id="ssl-transactions">
<h3>SSL Transactions<a class="headerlink" href="#ssl-transactions" title="Link to this heading">¶</a></h3>
<p>[image]</p>
</section>
<section id="tmm-client-side-throughput">
<h3>TMM Client-Side Throughput<a class="headerlink" href="#tmm-client-side-throughput" title="Link to this heading">¶</a></h3>
<p>The sum throughput of all Traffic Management Microkernel (TMM) and Packet Velocity ASIC (PVA) traffic on the client side. The following fields are represented in bits per second and packets per second:</p>
<p>Client In: The sum of all ingress traffic</p>
<p>Client Out: The sum of all egress traffic</p>
<p>[image]</p>
</section>
<section id="tmm-server-side-throughput">
<h3>TMM Server-Side Throughput<a class="headerlink" href="#tmm-server-side-throughput" title="Link to this heading">¶</a></h3>
<p>The sum throughput of all TMM and PVA traffic on the server side. The following fields are represented in bits per second and packets per second:</p>
<p>Server In: The sum of all egress traffic</p>
<p>Server Out: The sum of all ingress traffic</p>
<p>[image]</p>
</section>
<section id="throughput">
<h3>Throughput<a class="headerlink" href="#throughput" title="Link to this heading">¶</a></h3>
<p>The total throughput in and out of the BIG-IP system collected from all interfaces, including traffic processed by all Traffic Management Microkernel (TMM) and Packet Velocity ASIC (PVA), except the management interface. The following fields are represented in bits per second and packets per second:</p>
<p>In: The ingress traffic to the system through its interfaces</p>
<p>Out: The egress traffic from the system through its interfaces</p>
<p>Service: The larger of the two values of combined client and server-side ingress traffic or egress traffic, measured within TMM. You can compare this to VE-licensed bandwidth.</p>
<p>[image]</p>
</section>
</section>
<section id="irules">
<h2>iRules<a class="headerlink" href="#irules" title="Link to this heading">¶</a></h2>
<p>One of the first things to evaluate with irules, is if they are even being used. An effective way to gauge that is to check the Unused Objects under the Config Explorer. So, if you have 150 total irules, but are not using 102 of them, then that means we only need to review 48 irules, and based on historical evidence, I would estimate over 75% of those are just uncustomized redirect irules.</p>
<p>[image]</p>
</section>
<section id="commands">
<h2>Commands<a class="headerlink" href="#commands" title="Link to this heading">¶</a></h2>
<section id="list-ltm-virtual-all-properties">
<h3>list /ltm virtual all-properties<a class="headerlink" href="#list-ltm-virtual-all-properties" title="Link to this heading">¶</a></h3>
<p>A straightforward way, other than reviewing the bigip.conf is to use the list /ltm virtual all-properties command and then search for “rules {”.</p>
<p>IRules that can be ignored because it’s a checkbox choice in XC are redirects:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>rules {
     /Common/_sys_https_redirect
}
</pre></div>
</div>
<p>In the example QKView I am using, there are 670 instances of “rules”, and 468 instances of “/Common/_sys_https_redirect”. So, we have 202 instances of potential irules to evaluate, which is still pretty high.  But if we look at the irules, many customers have built custom redirects, which we can potentially ignore as well once we see they are just redirects.</p>
<p>Let’s look at an irule example, we can see it’s in use, and has had 34k executions in the past 30 days. I’m sure someone will argue the point, but this is still a redirect irule. Or you could call it an apology page. It’s setting the default pool, and if there aren’t any active members, sending it to another page.</p>
<p>[image]</p>
<p>This is extremely easy to do with just L7 Routes, and custom error pages.</p>
<p>In this qkview, there are mostly custom redirect irules based on host headers, over and over again.  This is a manual process, so be prepared to see a lot of redirects.</p>
<p>[image]</p>
<p>Then be prepared to see a ton of custom logging or header injections. Header Insert, Removal, and Appending can be easily done with the Load Balancer Advanced config, or more granularly via the L7 Route configs.</p>
<p>In the case of this irule, it’s just going to insert the header on every HTTP REQUEST. This is managed at the top-level Load Balancer Configs under More Options.</p>
<p>[image]
[image]</p>
<p>If this irule had more logic, IF host header = this.domain.com, then we would use the L7 Route options.</p>
<p>[image]</p>
</section>
<section id="show-ltm-profile-http-global">
<h3>show /ltm profile http global<a class="headerlink" href="#show-ltm-profile-http-global" title="Link to this heading">¶</a></h3>
<p>This command will give you a quick snapshot of traffic with a virtual server with an associated HTTP profile.</p>
<p>[image]</p>
<p>We can see that we have had about 532 million requests across all virtual servers (over the last 30 days in this example). We can also see that there were about 71 million redirects.</p>
<p>This data is perfect if we are evaluating an API use-case.</p>
</section>
</section>
<section id="unix-tmos-tmctl-a-blade">
<h2>UNIX - TMOS - tmctl -a (blade)<a class="headerlink" href="#unix-tmos-tmctl-a-blade" title="Link to this heading">¶</a></h2>
<p>This gets us to the TMSTATS collections that span usually beyond the last 30 days that the RRD Graphs might show. Scroll down to the profile_http link and click it. This will give the aggregate values as well as every individual virtual server with a HTTP profile in a table format with column headers that are clickable to sort the data based on the values. Within this you will also reveal where some dormant virtuals are that do not need to be considered for migrations.</p>
<p>[image]</p>
</section>
</section>
<section id="ltm-to-load-balancing-as-a-service">
<h1>LTM to Load Balancing as a Service<a class="headerlink" href="#ltm-to-load-balancing-as-a-service" title="Link to this heading">¶</a></h1>
<section id="ltm-to-customer-edge">
<h2>LTM to Customer Edge<a class="headerlink" href="#ltm-to-customer-edge" title="Link to this heading">¶</a></h2>
<p>The following ports can not be used when advertising services on a Customer Edge.</p>
<table class="docutils align-default" id="id5">
<caption><span class="caption-text">Reserved Ports</span><a class="headerlink" href="#id5" title="Link to this table">¶</a></caption>
<colgroup>
<col style="width: 50.0%" />
<col style="width: 50.0%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p>22</p></td>
<td><p>53</p></td>
</tr>
<tr class="row-even"><td><p>68</p></td>
<td><p>323</p></td>
</tr>
<tr class="row-odd"><td><p>500</p></td>
<td><p>1067</p></td>
</tr>
<tr class="row-even"><td><p>2379</p></td>
<td><p>2380</p></td>
</tr>
<tr class="row-odd"><td><p>4500</p></td>
<td><p>5355</p></td>
</tr>
<tr class="row-even"><td><p>6443</p></td>
<td><p>8005</p></td>
</tr>
<tr class="row-odd"><td><p>8007</p></td>
<td><p>8087</p></td>
</tr>
<tr class="row-even"><td><p>8443</p></td>
<td><p>8444</p></td>
</tr>
<tr class="row-odd"><td><p>8505</p></td>
<td><p>8507</p></td>
</tr>
<tr class="row-even"><td><p>9007</p></td>
<td><p>9090</p></td>
</tr>
<tr class="row-odd"><td><p>9153</p></td>
<td><p>9999</p></td>
</tr>
<tr class="row-even"><td><p>10249</p></td>
<td><p>10250</p></td>
</tr>
<tr class="row-odd"><td><p>10251</p></td>
<td><p>10252</p></td>
</tr>
<tr class="row-even"><td><p>10256</p></td>
<td><p>10257</p></td>
</tr>
<tr class="row-odd"><td><p>10259</p></td>
<td><p>18091</p></td>
</tr>
<tr class="row-even"><td><p>18092</p></td>
<td><p>18093</p></td>
</tr>
<tr class="row-odd"><td><p>18095</p></td>
<td><p>22222</p></td>
</tr>
<tr class="row-even"><td><p>23790</p></td>
<td><p>23791</p></td>
</tr>
<tr class="row-odd"><td><p>23801</p></td>
<td><p>23802</p></td>
</tr>
<tr class="row-even"><td><p>28000 - 32767 (volterra)</p></td>
<td><p>28000 - 32767 (kubernetes)</p></td>
</tr>
</tbody>
</table>
</section>
<section id="snat-pooling">
<h2>SNAT Pooling<a class="headerlink" href="#snat-pooling" title="Link to this heading">¶</a></h2>
<p>Today, XC does not support a traditional SNAT pool type configuration, however, you can scale SNAT based on nodes in a cluster.  So a 3 node cluster will have 3 IPs for SNATTING, if you need more SNAT IPs, then add more nodes.</p>
</section>
<section id="traffig-group-floating-self-ip">
<h2>Traffig Group / Floating Self-IP<a class="headerlink" href="#traffig-group-floating-self-ip" title="Link to this heading">¶</a></h2>
<p>To create the same scenario as a traffic group or floating self, you can use VRRP.  Check out Harmon’s article here, where he discusses some of the CE design scenarios.  <a class="reference external" href="https://community.f5.com/t5/technical-articles/f5-distributed-cloud-customer-edge-site-deployment-amp-routing/ta-p/319435">https://community.f5.com/t5/technical-articles/f5-distributed-cloud-customer-edge-site-deployment-amp-routing/ta-p/319435</a></p>
<p>A byproduct of enabling VRRP on your cluster, and creating a common VIP, is that you can also use that common VIP as a default gateway.</p>
</section>
<section id="custom-monitors">
<h2>Custom Monitors<a class="headerlink" href="#custom-monitors" title="Link to this heading">¶</a></h2>
<p>If you have been relying on custom monitors for routine tasks such as backing up data to an FTP server, sending email reports, or generating alerts based on storage availability. With F5 Distributed Cloud (XC), many of these functions are seamlessly integrated, thanks to our SaaS platform’s built-in scheduled reporting and alert capabilities.</p>
<p>However, if you need to perform a specific task that isn’t currently supported by XC, such as invoking an API or executing a specialized function, we’ve got you covered. You can easily recreate this functionality in a small container script (for example, using bash) and deploy it as a scheduled task within our virtual Kubernetes environment.</p>
<p>For instance, if you need to activate a service policy or a network firewall rule at particular times each day, you can set up a cron job in XC. This job will operate on your schedule and interact with the XC API to execute your policies as planned.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">CronJob</span>
<span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">batch/v1beta1</span>
<span class="nt">metadata</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">coleman-generic-restcurl</span>
<span class="w">  </span><span class="nt">labels</span><span class="p">:</span>
<span class="w">    </span><span class="nt">app</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">restcurl</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">cron</span>
<span class="w">  </span><span class="nt">annotations</span><span class="p">:</span>
<span class="w">    </span><span class="nt">ves.io/virtual-sites</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">m-coleman/coleman-ves-io-ny-re</span>
<span class="nt">spec</span><span class="p">:</span>
<span class="w">  </span><span class="nt">schedule</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;30</span><span class="nv"> </span><span class="s">10,20</span><span class="nv"> </span><span class="s">*</span><span class="nv"> </span><span class="s">*</span><span class="nv"> </span><span class="s">1-5&quot;</span><span class="w"> </span><span class="c1"># Every weekday at 10:30, and 20:30 UTC</span>
<span class="w">  </span><span class="nt">jobTemplate</span><span class="p">:</span>
<span class="w">    </span><span class="nt">metadata</span><span class="p">:</span>
<span class="w">      </span><span class="nt">labels</span><span class="p">:</span>
<span class="w">        </span><span class="nt">app</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">restcurl</span>
<span class="w">        </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">cron</span>
<span class="w">    </span><span class="nt">spec</span><span class="p">:</span>
<span class="w">      </span><span class="nt">template</span><span class="p">:</span>
<span class="w">        </span><span class="nt">metadata</span><span class="p">:</span>
<span class="w">          </span><span class="nt">annotations</span><span class="p">:</span>
<span class="w">            </span><span class="nt">ves.io/workload-flavor</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tiny</span>
<span class="w">            </span><span class="nt">ves.io/virtual-sites</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">m-coleman/coleman-ves-io-ny-re</span>
<span class="w">        </span><span class="nt">spec</span><span class="p">:</span>
<span class="w">          </span><span class="nt">restartPolicy</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Never</span>
<span class="w">          </span><span class="nt">containers</span><span class="p">:</span>
<span class="w">            </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">curl-worker</span>
<span class="w">              </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">curlimages/curl:latest</span>
<span class="w">              </span><span class="nt">imagePullPolicy</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">IfNotPresent</span>
<span class="w">              </span><span class="nt">env</span><span class="p">:</span>
<span class="w">                </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">API_URI</span>
<span class="w">                  </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;http://&lt;tenant&gt;.console.ves.volterra.io/api/web/namespaces&quot;</span>
<span class="w">                </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">API_TOKEN</span>
<span class="w">                  </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;APIToken</span><span class="nv"> </span><span class="s">&lt;token</span><span class="nv"> </span><span class="s">value&gt;&quot;</span>
<span class="w">                </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">API_METHOD</span>
<span class="w">                  </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;POST&quot;</span>
<span class="w">                </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">API_PAYLOAD</span>
<span class="w">                  </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;{&quot;metadata&quot;:</span><span class="nv"> </span><span class="s">{&quot;name&quot;:</span><span class="nv"> </span><span class="s">&quot;service-policy-1&quot;,&quot;namespace&quot;:</span><span class="nv"> </span><span class="s">&quot;namespace&quot;},</span><span class="nv"> </span><span class="s">&quot;spec&quot;:</span><span class="nv"> </span><span class="s">{</span><span class="nv"> </span><span class="s">&quot;deny_all_requests&quot;:</span><span class="nv"> </span><span class="s">{}</span><span class="nv"> </span><span class="s">}</span><span class="nv"> </span><span class="s">}&#39;</span>
<span class="w">              </span><span class="nt">command</span><span class="p">:</span>
<span class="w">                </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;/bin/sh&quot;</span>
<span class="w">                </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;-ec&quot;</span>
<span class="w">                </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="p p-Indicator">|</span>
<span class="w">                  </span><span class="no">set -o nounset</span>
<span class="w">                  </span><span class="no">set -o errexit</span>
<span class="w">                  </span><span class="no">echo &quot;API Call&quot;</span>
<span class="w">                  </span><span class="no">curl -s -X ${API_METHOD} -H &#39;Content-Type: application/json&#39; -H &quot;Authorization: ${API_TOKEN}&quot; &quot;${API_URI}&quot;</span>
</pre></div>
</div>
</section>
</section>
<section id="id4">
<h1>iRules<a class="headerlink" href="#id4" title="Link to this heading">¶</a></h1>
<p>If not clear, any irules that are performing redirects, header additions, rewrites, or appending values are easily migrated to L7 Routes. If the irules requires things like binary scan, that is something XC does not support today.</p>
<p>IRules that focus on Access Control based on evaluating IP blocks, client source addresses, etc., are easily migrated to Service Policies.</p>
<section id="rule-init">
<h2>RULE_INIT<a class="headerlink" href="#rule-init" title="Link to this heading">¶</a></h2>
<p>RULE_INIT is generally used to set some static variables for use in the rest of the irule, since we don’t have any programming logic in XC in order to take advantage of this, it can generally be thrown out, but pay attention to any definitions of data groups or things like that so you can understand the irules purpose; is it pulling domain names, is it pulling client ips, etc.</p>
</section>
<section id="client-accepted">
<h2>CLIENT_ACCEPTED<a class="headerlink" href="#client-accepted" title="Link to this heading">¶</a></h2>
<p>Depending on what is happening during CLIENT_ACCEPTED this event may not be needed, or if there is some complex action requirements it will not be a good possibility for porting. Most customers use this to log client ip/prefix data, or select a pool based on an identifying client attribute, this can be done via L7 Routes.</p>
</section>
<section id="clientssl-clientcert">
<h2>CLIENTSSL_CLIENTCERT<a class="headerlink" href="#clientssl-clientcert" title="Link to this heading">¶</a></h2>
<p>This event is probably not as common outside of mTLS use-cases, and in many cases is just used for logging, but also commonly used to create SSL Session ID’s for Persistence use-cases. While XC does not support SSL Session ID persistence today, it does support mTLS, and it can extract the X.509 attributes and inject into headers to use for similar purposes.</p>
<p>If we evaluate the following example:</p>
<div class="highlight-tcl notranslate"><div class="highlight"><pre><span></span><span class="nv">when</span><span class="w"> </span>CLIENTSSL_CLIENTCERT<span class="w"> </span><span class="k">{</span>
<span class="w">   </span><span class="k">set</span><span class="w"> </span>cert<span class="w"> </span><span class="k">[</span><span class="nv">SSL</span><span class="o">::</span>cert<span class="w"> </span><span class="mi">0</span><span class="k">]</span>
<span class="w">   </span><span class="c"># Save the cert fields to a list</span>
<span class="w">   </span><span class="k">set</span><span class="w"> </span>fields<span class="w"> </span><span class="k">[</span><span class="nv">X509</span><span class="o">::</span>cert_fields<span class="w"> </span><span class="nv">$cert</span><span class="w"> </span><span class="k">[</span><span class="nv">SSL</span><span class="o">::</span>verify_result<span class="k">]</span><span class="w"> </span>hash<span class="w"> </span>issuer<span class="w"> </span>serial<span class="w"> </span>sigalg<span class="w"> </span>subject<span class="w"> </span>subpubkey<span class="w"> </span>validity<span class="w"> </span>versionnum<span class="w"> </span>whole<span class="k">]</span>
<span class="w">   </span><span class="nv">log</span><span class="w"> </span>local0.<span class="w"> </span><span class="s2">&quot;Client certificate fields - $fields&quot;</span>
<span class="w">   </span><span class="c"># Add the cert to the session table for use in subsequent HTTP requests.  Use the SSL session ID as the key.</span>
<span class="w">   </span><span class="nv">session</span><span class="w"> </span>add<span class="w"> </span>ssl<span class="w"> </span><span class="k">[</span><span class="nv">SSL</span><span class="o">::</span>sessionid<span class="k">]</span><span class="w"> </span><span class="k">[</span><span class="nb">list</span><span class="w"> </span><span class="nv">$cert</span><span class="w"> </span><span class="nv">$fields</span><span class="k">]</span><span class="w"> </span><span class="nv">$::session_timeout</span>
<span class="k">}</span>
</pre></div>
</div>
<p>We can use mTLS configuration to extract the X.509 Values.</p>
<p>[image]</p>
<p>Which we can then use for logic in the L7 routes.</p>
</section>
<section id="lb-selected-lb-failed">
<h2>LB_SELECTED &amp; LB_FAILED<a class="headerlink" href="#lb-selected-lb-failed" title="Link to this heading">¶</a></h2>
<p>Depending on the use-case here, it’s possible that we can supply simple solutions in XC to match functionality. Are you sending an apology page, are you redirecting, etc.</p>
</section>
<section id="http-request">
<h2>HTTP_REQUEST<a class="headerlink" href="#http-request" title="Link to this heading">¶</a></h2>
<p>Depending on what is happening here, most irules are easily portable to L7 routes, excluding any collection or streaming. Setting, removing, and appending HTTP Headers can be carried out in several ways, including AND/OR logic for modification.</p>
</section>
<section id="http-request-data">
<h2>HTTP_REQUEST_DATA<a class="headerlink" href="#http-request-data" title="Link to this heading">¶</a></h2>
<p>XC does not support HTTP Collect or streaming, so irules that rely heavily on this event will not be a good fit. However, you can do service chaining with NGINX in vk8s to carry out the end goal in some cases.</p>
<p>HTTP_RESPONSE</p>
<p>Like HTTP_REQUEST, this should be easily portable to L7 routes in XC.  For example:</p>
<div class="highlight-tcl notranslate"><div class="highlight"><pre><span></span><span class="nv">when</span><span class="w"> </span>HTTP_RESPONSE<span class="w"> </span><span class="k">{</span>
<span class="w">   </span><span class="nv">HTTP</span><span class="o">::</span>header<span class="w"> </span>insert<span class="w"> </span>Strict-Transport-Security<span class="w"> </span><span class="s2">&quot;max-age= 31536000&quot;</span>
<span class="w">   </span><span class="nv">HTTP</span><span class="o">::</span>header<span class="w"> </span>insert<span class="w"> </span><span class="s2">&quot;X-FRAME-OPTIONS&quot;</span><span class="w"> </span><span class="s2">&quot;SAMEORIGIN&quot;</span>
<span class="k">}</span>
</pre></div>
</div>
</section>
<section id="http-response-data">
<h2>HTTP_RESPONSE_DATA<a class="headerlink" href="#http-response-data" title="Link to this heading">¶</a></h2>
<p>XC does not support HTTP Collect or streaming, so irules that rely heavily on this event will not be a good fit. However, you can do service chaining with NGINX in vk8s to carry out the end goal in some cases.</p>
</section>
<section id="access-session-started-access-policy-agent-event-access-policy-completed-access-acl-denied-access-acl-allowed-rewrite-request-done-rewrite-response-done-access-session-closed">
<h2>ACCESS_SESSION_STARTED, ACCESS_POLICY_AGENT_EVENT, ACCESS_POLICY_COMPLETED, ACCESS_ACL_DENIED, ACCESS_ACL_ALLOWED, REWRITE_REQUEST_DONE, REWRITE_RESPONSE_DONE, ACCESS_SESSION_CLOSED<a class="headerlink" href="#access-session-started-access-policy-agent-event-access-policy-completed-access-acl-denied-access-acl-allowed-rewrite-request-done-rewrite-response-done-access-session-closed" title="Link to this heading">¶</a></h2>
<p>Since these are all APM iRules events, they are not supported in XC.  What we can do is evaluate incoming headers; MRH_Session, www-authenticate, etc., and make decisions on traffic.</p>
</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<search id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script>
  <div>
    <h3><a href="#">Table of Contents</a></h3>
    <ul>
<li><a class="reference internal" href="#">BIG-IP To Distributed Cloud Conversion Frequently Asked Questions and Tips</a></li>
<li><a class="reference internal" href="#disclaimer">Disclaimer</a></li>
<li><a class="reference internal" href="#introduction">Introduction</a></li>
<li><a class="reference internal" href="#disqualifiers">Disqualifiers</a></li>
<li><a class="reference internal" href="#access-policy-manager">Access Policy Manager</a></li>
<li><a class="reference internal" href="#local-traffic-manager">Local Traffic Manager</a></li>
<li><a class="reference internal" href="#tools">Tools</a></li>
<li><a class="reference internal" href="#apm-to-ditributed-cloud-service-chaining">APM to Ditributed Cloud (Service Chaining)</a><ul>
<li><a class="reference internal" href="#api-security">API Security</a></li>
</ul>
</li>
<li><a class="reference internal" href="#qkview-ihealth">QKView - iHealth</a><ul>
<li><a class="reference internal" href="#graphs">Graphs</a><ul>
<li><a class="reference internal" href="#ssl-transactions">SSL Transactions</a></li>
<li><a class="reference internal" href="#tmm-client-side-throughput">TMM Client-Side Throughput</a></li>
<li><a class="reference internal" href="#tmm-server-side-throughput">TMM Server-Side Throughput</a></li>
<li><a class="reference internal" href="#throughput">Throughput</a></li>
</ul>
</li>
<li><a class="reference internal" href="#irules">iRules</a></li>
<li><a class="reference internal" href="#commands">Commands</a><ul>
<li><a class="reference internal" href="#list-ltm-virtual-all-properties">list /ltm virtual all-properties</a></li>
<li><a class="reference internal" href="#show-ltm-profile-http-global">show /ltm profile http global</a></li>
</ul>
</li>
<li><a class="reference internal" href="#unix-tmos-tmctl-a-blade">UNIX - TMOS - tmctl -a (blade)</a></li>
</ul>
</li>
<li><a class="reference internal" href="#ltm-to-load-balancing-as-a-service">LTM to Load Balancing as a Service</a><ul>
<li><a class="reference internal" href="#ltm-to-customer-edge">LTM to Customer Edge</a></li>
<li><a class="reference internal" href="#snat-pooling">SNAT Pooling</a></li>
<li><a class="reference internal" href="#traffig-group-floating-self-ip">Traffig Group / Floating Self-IP</a></li>
<li><a class="reference internal" href="#custom-monitors">Custom Monitors</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id4">iRules</a><ul>
<li><a class="reference internal" href="#rule-init">RULE_INIT</a></li>
<li><a class="reference internal" href="#client-accepted">CLIENT_ACCEPTED</a></li>
<li><a class="reference internal" href="#clientssl-clientcert">CLIENTSSL_CLIENTCERT</a></li>
<li><a class="reference internal" href="#lb-selected-lb-failed">LB_SELECTED &amp; LB_FAILED</a></li>
<li><a class="reference internal" href="#http-request">HTTP_REQUEST</a></li>
<li><a class="reference internal" href="#http-request-data">HTTP_REQUEST_DATA</a></li>
<li><a class="reference internal" href="#http-response-data">HTTP_RESPONSE_DATA</a></li>
<li><a class="reference internal" href="#access-session-started-access-policy-agent-event-access-policy-completed-access-acl-denied-access-acl-allowed-rewrite-request-done-rewrite-response-done-access-session-closed">ACCESS_SESSION_STARTED, ACCESS_POLICY_AGENT_EVENT, ACCESS_POLICY_COMPLETED, ACCESS_ACL_DENIED, ACCESS_ACL_ALLOWED, REWRITE_REQUEST_DONE, REWRITE_RESPONSE_DONE, ACCESS_SESSION_CLOSED</a></li>
</ul>
</li>
</ul>

  </div>
<h3><a href="#">Table of Contents</a></h3>

        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="nav-item nav-item-0"><a href="#">BIG-IP to XC 2024 documentation</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">BIG-IP To Distributed Cloud Conversion Frequently Asked Questions and Tips</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
    &#169; Copyright 2024, Michael Coleman.
      Last updated on 2024-04-29 12:17:43.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 7.3.7.
    </div>
  </body>
</html>